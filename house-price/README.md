# 캐글 주택 가격 예측 (Kaggle House Prices Prediction)

## 1\. 프로젝트 개요

이 프로젝트는 캐글(Kaggle)의 "House Prices: Advanced Regression Techniques" 경진대회를 위한 예측 모델을 개발하는 과정을 담고 있습니다. 아이오와 주 에임스(Ames, Iowa) 지역 주택들의 다양한 특성(feature) 데이터를 활용하여 최종 판매 가격(`SalePrice`)을 예측하는 것을 목표로 합니다.

본 프로젝트는 데이터 탐색(EDA), 정교한 특성 공학(Feature Engineering), 그리고 **스태킹(Stacking)과 블렌딩(Blending)을 포함한 고급 앙상블 모델링** 기법을 적용하여 예측의 정확도를 극대화하는 데 중점을 두었습니다.

-----

## 2\. 분석 방법론

### 2.1. 탐색적 데이터 분석 (EDA) 및 전처리

모델 성능을 높이기 위해 데이터의 특성을 깊이 있게 분석하고 다음과 같은 전처리 과정을 수행했습니다.

  * **타겟 변수 정규화:** 주택 가격(`SalePrice`)의 분포가 오른쪽으로 치우쳐져 있는 것을 확인하고, \*\*로그 변환(Log Transformation)\*\*을 적용하여 분포를 정규분포에 가깝게 만들었습니다. 이는 모델이 가격을 더 안정적으로 예측하는 데 도움을 줍니다.
  * **이상치(Outlier) 제거:** `GrLivArea`(지상 생활 면적) 특성에서 가격에 비해 비정상적으로 큰 면적을 가진 두 개의 이상치를 발견하고 제거하여 모델의 예측 왜곡을 방지했습니다.
  * **결측치 처리:**
      * **수치형 변수:** `LotFrontage`와 같이 중요한 수치형 변수는 전체 평균이나 중앙값이 아닌, **`Neighborhood`(지역)별 중앙값**으로 채워 넣어 더 정확한 값을 추정했습니다.
      * **범주형 변수:** 데이터 설명서(data\_description.txt)를 참고하여 'NA' 값이 '없음'을 의미하는 특성(예: `PoolQC`, `Fence`)들은 'None'이라는 새로운 범주로 채웠습니다. 최빈값으로 채워야 하는 특성들은 그에 맞게 처리했습니다.
  * **특성 공학 (Feature Engineering):**
      * `TotalSF`: 전체 면적과 관련된 특성들을 조합하여 총면적(`TotalSF`)이라는 새로운 특성을 생성했습니다.
      * `YrBltAndRemod`: 건축 연도와 리모델링 연도를 합산하여 주택의 전체적인 연식을 반영하는 특성을 만들었습니다.
      * **Porch SF**: 여러 종류의 현관 면적을 합산하여 총 현관 면적 특성을 생성했습니다.
      * **Porch Features**: 현관의 존재 유무를 나타내는 이진 특성들을 만들었습니다.
  * **범주형 변수 인코딩:** `LabelEncoder`와 `pd.get_dummies` (원-핫 인코딩)를 사용하여 범주형 데이터를 모델이 학습할 수 있는 숫자 형태로 변환했습니다.

-----

## 3\. 모델링 전략: 고급 앙상블

단일 모델의 한계를 극복하고 예측의 안정성과 정확도를 높이기 위해 다음과 같은 두 단계의 고급 앙상블 기법을 적용했습니다.

### 3.1. 스태킹 앙상블 (Stacking Ensemble)

여러 개의 다양한 기본 모델(Base Models)이 예측한 결과를 다시 새로운 모델(Meta Model)의 학습 데이터로 사용하여 최종 예측을 수행하는 기법입니다.

  * **1단계: 기본 모델 (Base Models)**

      * 서로 다른 특성을 잘 잡아내는 다양한 유형의 모델 5개를 선정하여 개별적으로 예측을 수행했습니다.
      * 사용한 모델:
        1.  `Lasso`
        2.  `ElasticNet`
        3.  `KernelRidge`
        4.  `GradientBoostingRegressor`
        5.  `XGBoost`
        6.  `LightGBM`

  * **2단계: 메타 모델 (Meta Model)**

      * 위 6개 모델이 예측한 결과를 입력 데이터로 받아 최종 주택 가격을 예측하는 메타 모델로 `Lasso`를 사용했습니다.

### 3.2. 블렌딩 (Blending)

스태킹 모델의 예측 결과와, 별도로 튜닝된 강력한 단일 모델들의 예측 결과를 **가중 평균**하여 최종 예측값을 생성합니다. 이를 통해 특정 모델에 과적합될 위험을 줄이고 예측의 안정성을 한층 더 높일 수 있습니다.

  * **블렌딩 모델 구성:**

      * `Stacked Regressor`: 위에서 만든 스태킹 모델의 예측값
      * `XGBoost`: 단독으로 최적화된 XGBoost 모델의 예측값
      * `LightGBM`: 단독으로 최적화된 LightGBM 모델의 예측값

  * **최종 예측:**

    ```
    Final Prediction = 0.70 * Stacked_Prediction + 0.15 * XGBoost_Prediction + 0.15 * LightGBM_Prediction
    ```
